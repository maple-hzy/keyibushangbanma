---
title: 5.分布式事务
date: 2022-09-22 15:39:13
permalink: /pages/5
categories:
  - 刷题分享
  - 分布式事务
tags:
  - 
---
### 分布式事务落地方案
项目中使用的MQ最终一致性，结合RabbitMQ使用，利用RabbitMQ的Confirm确认机制完成，生产者端Confirm使用阻塞方式确认消息是否发送成功，消息投递失败时候，将数据记录在MySQL数据库中，定时任务进行异常事务处理，消费者端Confirm机制使用try方法的finally中执行手动ack机制确定事务正常执行

### CAP理论
C:一致性  
A:可用性  
P:分区容错性  
### BASE理论
B,A:基本可用（Basically Available）  
S:软状态（ Soft State）  
E:最终一致性（ Eventual Consistency）  
### 分布式事务的解决
TCC：事务补偿机制  
2PC：两阶段提交，先预备数据，最后提交数据  
本地消息表：将需要分布式处理的任务通过消息或日志的形式来异步执行，消息或日志可以存到本地文件、数据库或消息队列，再通过业务规则进行失败重试，它要求各服务的接口是幂等的。  